ERDMatchCount AS (
    SELECT
        ae.Month_Year,
        COUNT(*) AS ERD_Match_Count
    FROM ActiveEmployees ae
    LEFT JOIN PSEmployeeAdditionalDetails ad ON ae.EmployeeEmail = ad.EmployeeEmail
    WHERE MONTH(ad.ERD) = MONTH(GETDATE()) AND YEAR(ad.ERD) = YEAR(GETDATE())
    GROUP BY ae.Month_Year
)p
