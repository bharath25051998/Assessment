# Add .NET assemblies for sending keystrokes
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

# Function to generate a random letter
function Get-RandomLetter {
    $letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    $index = Get-Random -Minimum 0 -Maximum $letters.Length
    return $letters[$index]
}

# Function to send a keystroke
function Send-Key {
    param (
        [string]$key
    )
    [System.Windows.Forms.SendKeys]::SendWait($key)
}

# Main script to write random letters
$durationInMinutes = 10  # Duration to run the script
$endTime = (Get-Date).AddMinutes($durationInMinutes)

Start-Sleep -Seconds 5  # Give user time to switch to VS Code

while ((Get-Date) -lt $endTime) {
    $randomLetter = Get-RandomLetter
    Write-Output "Typing letter: $randomLetter"  # Debug output
    Send-Key $randomLetter
    Start-Sleep -Milliseconds 500  # Adjust the delay as needed
}
