static DataTable TransposeDataTable(DataTable inputTable)
{
    DataTable outputTable = new DataTable();

    // Add rows to the output table
    for (int i = 0; i < inputTable.Columns.Count; i++)
    {
        DataRow newRow = outputTable.NewRow();
        for (int j = 0; j < inputTable.Rows.Count; j++)
        {
            // Ensure the output table has enough columns
            if (outputTable.Columns.Count <= j)
            {
                outputTable.Columns.Add(inputTable.Rows[j][0].ToString());
            }

            // Fill the transposed data
            if (i == 0)
            {
                newRow[j] = inputTable.Rows[j][0];
            }
            else
            {
                newRow[inputTable.Rows[j][0].ToString()] = inputTable.Rows[j][i];
            }
        }
        outputTable.Rows.Add(newRow);
    }

    return outputTable;
}
