<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DataTable Export Example</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.2/css/buttons.dataTables.min.css">
</head>
<body>

<table id="example" class="display" style="width:100%">
    <thead>
        <tr>
            <th>Name</th>
            <th>Position</th>
            <th>Office</th>
            <th>Age</th>
            <th>Start date</th>
            <th>Salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Tiger Nixon</td>
            <td>System Architect</td>
            <td>Edinburgh</td>
            <td>61</td>
            <td>2011/04/25</td>
            <td>$12,400</td>
        </tr>
        <!-- Additional rows here -->
    </tbody>
</table>

<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.print.min.js"></script>

<script>
$(document).ready(function() {
    var table = $('#example').DataTable({
        dom: 'Bfrtip',
        buttons: [
            {
                extend: 'excelHtml5',
                text: 'Export to Excel',
                customize: function (xlsx) {
                    var sheet = xlsx.xl.worksheets['sheet1.xml'];
                    
                    // Iterate over each cell in the F column (assuming the dollar values are in the 6th column, adjust as needed)
                    $('row c[r^="F"]', sheet).each(function () {
                        // Get the cell reference
                        var cellRef = $(this).attr('r');
                        
                        // Find the corresponding cell in the data table
                        var cellValue = table.cell(parseInt(cellRef.slice(1)) - 2, 5).data(); // Adjust the column index if necessary
                        
                        // Check if the cell value is a dollar value
                        if (typeof cellValue === 'string' && cellValue.includes('$')) {
                            // Set the cell type to string (inlineStr)
                            $(this).attr('t', 'inlineStr');
                            // Wrap the cell value in a 'is' tag to ensure it is treated as inline string
                            $(this).html('<is><t>' + cellValue + '</t></is>');
                        } else {
                            $(this).text(cellValue);
                        }
                    });
                    
                    // Optional: Remove the first row if it is an extra header
                    $('row:first', sheet).remove();
                }
            }
        ],
        columnDefs: [
            {
                targets: '_all',
                visible: true
            }
        ]
    });
});
</script>

</body>
</html>
