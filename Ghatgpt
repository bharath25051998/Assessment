SELECT 
    ap.ddstatusid,
    FORMAT(SUM(CASE WHEN lb.lob = 'lob1' THEN ap.quote_in_dollars ELSE 0 END), 'C', 'en-US') AS lob1,
    FORMAT(SUM(CASE WHEN lb.lob = 'lob2' THEN ap.quote_in_dollars ELSE 0 END), 'C', 'en-US') AS lob2,
    FORMAT(SUM(CASE WHEN lb.lob = 'lob3' THEN ap.quote_in_dollars ELSE 0 END), 'C', 'en-US') AS lob3,
    FORMAT(SUM(ap.quote_in_dollars), 'C', 'en-US') AS grand_total
FROM 
    app_profile ap
JOIN 
    lob_table lb ON ap.lob = lb.lob
GROUP BY 
    ap.ddstatusid
