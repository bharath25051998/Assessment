<script>
$(document).ready(function() {
    $('#example').DataTable({
        dom: 'Bfrtip',
        buttons: [
            {
                extend: 'excelHtml5',
                text: 'Export to Excel',
                customize: function (xlsx) {
                    var sheet = xlsx.xl.worksheets['sheet1.xml'];
                    
                    // Iterate over each cell in the F column (assuming the dollar values are in the 6th column, adjust as needed)
                    $('row c[r^="F"]', sheet).each(function () {
                        // Get the cell reference
                        var cellRef = $(this).attr('r');
                        
                        // Find the corresponding cell in the data table
                        var cellValue = $('#example').DataTable().cell(cellRef).data();
                        
                        // Remove formatting changes and keep the original string
                        $(this).text(cellValue);
                    });
                }
            }
        ],
        columnDefs: [
            {
                targets: '_all',
                visible: true
            }
        ]
    });
});
</script>
