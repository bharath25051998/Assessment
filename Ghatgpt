CREATE PROCEDURE GetQuestions 
    @CourseID INT
AS
BEGIN
    SELECT 
        q.questionid, 
        q.questiontext,
        -- Creating an options array with indication of the correct answer
        (SELECT 
            value AS optionText,
            CASE 
                WHEN value = q.correctanswer THEN 1
                ELSE 0 
            END AS isTrue
         FROM STRING_SPLIT(q.options, ';')
         FOR JSON PATH) AS optionsArray
    FROM 
        YourQuestionsTable q
    WHERE 
        q.courseid = @CourseID
    FOR JSON PATH; -- Optional, for JSON output
END
