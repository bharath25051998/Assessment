public List<Question> MapDataSetToQuestions(DataSet dataSet)
{
    var questions = new List<Question>();

    if (dataSet?.Tables.Count > 0)
    {
        DataTable table = dataSet.Tables[0];
        foreach (DataRow row in table.Rows)
        {
            var question = new Question
            {
                CourseID = Convert.ToInt32(row["CourseID"]),
                AssessmentQuestionID = Convert.ToInt32(row["AssessmentQuestionID"]),
                QuestionType = Convert.ToInt32(row["QuestionType"]),
                QuestionText = row["QuestionText"].ToString().Trim(),
                Options = new List<Option>(),
                CorrectAnswers = new List<string>()
            };

            var optionsText = row["OptionText"].ToString().Split(';');
            var correctAnswers = row["QuestionType"].ToString() == "1"
                ? new List<string> { row["answer"].ToString().Trim() }
                : row["answer"].ToString().Split(';').Select(a => a.Trim()).ToList();

            foreach (var optionText in optionsText)
            {
                var trimmedOptionText = optionText.Trim();
                var isCorrectAnswer = correctAnswers.Contains(trimmedOptionText);
                question.Options.Add(new Option
                {
                    Text = trimmedOptionText,
                    IsCorrect = isCorrectAnswer
                });

                if (isCorrectAnswer)
                {
                    question.CorrectAnswers.Add(trimmedOptionText);
                }
            }

            questions.Add(question);
        }
    }

    return questions;
}
