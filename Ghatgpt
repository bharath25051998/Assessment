WITH ActiveEmployees AS (
    SELECT DISTINCT
        ul.EmployeeEmail
    FROM psuserlogin ul
    WHERE ul.DeleteStatus = 0
),
BenchCount AS (
    SELECT
        CONCAT(DATENAME(MONTH, fromdate), '-', DATEPART(YEAR, fromdate)) AS Month_Year,
        COUNT(DISTINCT ae.EmployeeEmail) AS Bench_Count
    FROM #temp1 t
    CROSS JOIN ActiveEmployees ae
    WHERE NOT EXISTS (
        SELECT 1
        FROM #temp1
        WHERE CONCAT(DATENAME(MONTH, t.fromdate), '-', DATEPART(YEAR, t.fromdate)) = CONCAT(DATENAME(MONTH, fromdate), '-', DATEPART(YEAR, fromdate))
            AND EmployeeEmail = ae.EmployeeEmail
    )
    GROUP BY CONCAT(DATENAME(MONTH, fromdate), '-', DATEPART(YEAR, fromdate))
)
SELECT * FROM BenchCount;
