<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export Hidden Table to Excel</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        /* Hide the table from the UI */
        #hiddenTable {
            display: none;
        }
    </style>
</head>
<body>
    <div class="row">
        <div class="container-box col-md-12">
            <div class="row">
                <div class="col-md-4 bordered">
                    <div class="header">Legacy Technology Stack</div>
                    <p id="legacyTechnologyStack">Content for Legacy Technology Stack</p>
                </div>
                <div class="col-md-4 bordered">
                    <div class="header">Target Technology Stack</div>
                    <p id="targetTechnologyStack">Content for Target Technology Stack</p>
                </div>
                <div class="col-md-4 bordered">
                    <div class="header">Scope AAF</div>
                    <p id="scopeAAF">Content for Scope AAF</p>
                </div>
            </div>
        </div>
    </div>
    <br>
    <button id="exportExcel">Export to Excel</button>

    <!-- Hidden Table -->
    <table id="hiddenTable">
        <thead>
            <tr>
                <th>Legacy Technology Stack</th>
                <th>Target Technology Stack</th>
                <th>Scope AAF</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="hiddenLegacyTechnologyStack">Content for Legacy Technology Stack</td>
                <td id="hiddenTargetTechnologyStack">Content for Target Technology Stack</td>
                <td id="hiddenScopeAAF">Content for Scope AAF</td>
            </tr>
        </tbody>
    </table>

    <script>
        $(document).ready(function () {
            $('#exportExcel').click(function () {
                // Export hidden table to Excel
                exportHiddenTableToExcel();
            });
        });

        function exportHiddenTableToExcel() {
            // Initialize a new workbook
            var wb = XLSX.utils.book_new();
            
            // Convert the hidden table to a worksheet
            var ws = XLSX.utils.table_to_sheet(document.getElementById('hiddenTable'));
            
            // Add worksheet to the workbook
            XLSX.utils.book_append_sheet(wb, ws, 'Technology Stacks');
            
            // Generate Excel file and save
            var wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
            saveAs(new Blob([s2ab(wbout)], { type: 'application/octet-stream' }), 'technology_stacks.xlsx');
        }

        function s2ab(s) {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i < s.length; i++) {
                view[i] = s.charCodeAt(i) & 0xFF;
            }
            return buf;
        }
    </script>
</body>
</html>
