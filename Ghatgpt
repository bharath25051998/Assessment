traces
| where timestamp >= ago(1d)
| where message has "Running task" or message matches regex @"Task .+ completed"
| extend 
    ServiceName = extract(@"Running task (.+)", 1, message, typeof(string))
                 ?? extract(@"Task (.+) completed", 1, message, typeof(string)),
    Action = iff(message has "Running task", "Start", "End"),
    Status = iff(Action == "End", "Success", "Running")
| summarize
    StartDate = minif(Action == "Start", timestamp, datetime(null)),
    EndDate = maxif(Action == "End", timestamp, datetime(null)),
    FinalStatus = any(Status)
    by ServiceName
| order by ServiceName asc
