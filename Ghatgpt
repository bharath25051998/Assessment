function exportTableToExcel(tableID, filename = 'excel_data') {
    var table = $('#' + tableID).DataTable();
    
    // Remove any search filters to ensure all rows are included
    table.search('').columns().search('').draw();
    
    var allRows = [];
    
    table.rows().every(function () {
        var data = this.data();
        allRows.push(data);
    });
    
    var wb = XLSX.utils.book_new();
    var ws = XLSX.utils.aoa_to_sheet(allRows);
    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
    
    // Specify filename
    filename = filename ? filename + '.xlsx' : 'excel_data.xlsx';
    
    // Create download link element
    XLSX.writeFile(wb, filename);
}
