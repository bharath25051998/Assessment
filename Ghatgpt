<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DataTable Export Example</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
</head>
<body>
    <table id="example" class="display" style="width:100%">
        <thead>
            <tr>
                <th>Name</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Tiger Nixon</td>
                <td>$12,356</td>
            </tr>
            <tr>
                <td>Garrett Winters</td>
                <td>$1,000</td>
            </tr>
            <tr>
                <td>Ashton Cox</td>
                <td>$123,456</td>
            </tr>
            <!-- Add more rows as needed -->
        </tbody>
    </table>

    <script>
        $(document).ready(function() {
            $('#example').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'excelHtml5',
                        text: 'Export to Excel',
                        exportOptions: {
                            columns: ':visible',
                            format: {
                                body: function (data, row, column, node) {
                                    // Apply formatting only from row 3 onwards (0-indexed, so from row 2 onwards)
                                    if (row >= 2 && column === 1) {
                                        // Remove the $ symbol and commas
                                        var numberValue = parseFloat(data.replace(/[$,]/g, ''));
                                        // Reformat the number as currency with 0 decimals and $
                                        return '$' + numberValue.toFixed(0);
                                    }
                                    return data;
                                }
                            }
                        }
                    }
                ]
            });
        });
    </script>
</body>
</html>
