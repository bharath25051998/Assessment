function exportTableToExcel(tableID, filename = 'excel_data') {
    var table = $('#' + tableID).DataTable();
    
    // Remove any search filters to ensure all rows are included
    table.search('').columns().search('').draw();
    
    var allRows = [];
    var headers = [];
    
    // Extract headers
    $(table.table().header()).find('th').each(function () {
        headers.push($(this).text());
    });
    
    // Push headers to the beginning of the dataset
    allRows.push(headers);
    
    // Extract data rows
    table.rows().every(function () {
        var rowData = [];
        $(this.node()).find('td').each(function () {
            // Extract text of the hyperlink if exists
            var cellText = $(this).find('a').length ? $(this).find('a').text() : $(this).text();
            // If cellText is empty, extract innerText
            cellText = cellText || $(this).prop('innerText');
            rowData.push(cellText);
        });
        allRows.push(rowData);
    });
    
    var wb = XLSX.utils.book_new();
    var ws = XLSX.utils.aoa_to_sheet(allRows);
    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
    
    // Specify filename
    filename = filename ? filename + '.xlsx' : 'excel_data.xlsx';
    
    // Create download link element
    XLSX.writeFile(wb, filename);
}
