// Function to export table data to Excel
function exportTableToExcel(tableID, filename = '') {
    var table = $('#' + tableID).DataTable();
    var allData = table.rows().data().toArray();
    
    // Create Excel file from allData
    createExcelFile(allData, filename);
}

// Function to create Excel file from data
function createExcelFile(data, filename) {
    var wb = XLSX.utils.book_new();
    var ws = XLSX.utils.json_to_sheet(data);
    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
    XLSX.writeFile(wb, filename + '.xlsx');
}

// Call exportTableToExcel function when needed
exportTableToExcel('dataTable', 'excel_data');
